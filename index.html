<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dualâ€‘Semester Grades Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
  <style>
    /* ===== Base ===== */
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins',sans-serif; }
    body.light-mode { background: linear-gradient(135deg,#2ebf91,#8360c3); color:#222; }
    body.dark-mode  { background:#121212; color:#ddd; }
    .container {
      max-width:700px; width:95%; margin:20px auto;
      background:rgba(255,255,255,0.95); border-radius:12px;
      padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.2);
      transition:background .3s,color .3s;
    }
    body.dark-mode .container {
      background:#1e1e1e; box-shadow:0 4px 12px rgba(0,0,0,0.8);
    }
    @keyframes fadeIn { from{opacity:0;transform:translateY(-5px)} to{opacity:1;transform:translateY(0)} }
    .container { animation:fadeIn .4s ease; }

    header { text-align:center; margin-bottom:15px; }
    header h1 { font-size:1.8rem; margin-bottom:8px; }
    .toggles {
      display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-bottom:20px;
    }
    .tab-btn, .toggle-btn {
      display:inline-flex; align-items:center; gap:6px;
      padding:8px 12px; border:none; border-radius:6px; cursor:pointer;
      font-size:1rem; transition:background .2s;
    }
    .tab-btn { background:#ddd; color:#333; flex:1 1 120px; text-align:center; }
    .tab-btn.active { background:#2ebf91; color:#fff; }
    .toggle-btn { background:#2ebf91; color:#fff; }
    .toggle-btn:hover { background:#239d77; }

    /* Tooltip */
    .tooltip {
      position:relative; display:inline-block; cursor:help; margin-left:4px;
    }
    .tooltip .tiptext {
      visibility:hidden; width:200px; background:#333; color:#fff;
      text-align:left; padding:8px; border-radius:6px;
      position:absolute; z-index:1; bottom:125%; left:50%; transform:translateX(-50%);
      opacity:0; transition:opacity .2s; font-size:.85rem;
    }
    .tooltip:hover .tiptext,
    .tooltip:focus .tiptext {
      visibility:visible; opacity:1;
    }

    /* Table & Inputs */
    .table-wrap { overflow-x:auto; margin-bottom:15px; }
    table { width:100%; min-width:500px; border-collapse:collapse; }
    th, td {
      border:1px solid #ccc; text-align:center; padding:10px; transition:background .2s;
    }
    th { background:#f0f0f0; font-weight:600; }
    body.dark-mode th { background:#333; color:#eee; }
    td input {
      width:90%; padding:8px; font-size:1rem;
      border:1px solid #aaa; border-radius:4px; text-align:center;
      background:#fafafa; transition:background .2s,border .2s;
    }
    body.dark-mode td input {
      background:#2a2a2a; color:#eee; border:1px solid #555;
    }
    td input:focus { border-color:#2ebf91; outline:none; }
    tr { height:48px; }

    .pass { background:rgba(100,255,100,0.3); }
    .fail { background:rgba(255,100,100,0.3); }

    /* Buttons */
    .btn-container {
      display:flex; flex-wrap:wrap; justify-content:space-between; gap:10px; margin-bottom:15px;
    }
    .btn-container .left, .btn-container .right {
      display:flex; align-items:center; gap:8px; flex-wrap:wrap;
    }
    .btn-container label {
      margin-left:4px; font-size:1rem;
    }
    .btn-container input[type="checkbox"] { transform:scale(1.3); }
    button {
      flex:1 1 140px; padding:10px; font-size:1rem;
      border:none; border-radius:6px; background:#2ebf91; color:#fff;
      display:inline-flex; align-items:center; gap:6px; transition:background .2s;
    }
    button:hover { background:#239d77; }
    button.reset { background:#e74c3c; }

    .remark {
      text-align:center; font-size:1.1rem; font-weight:600;
      margin-top:10px; padding:12px; border-radius:8px;
    }
    .unique-message {
      text-align:center; font-size:.95rem; font-style:italic;
      margin-top:6px; color:#555;
    }

    /* Confetti */
    .confetti-piece {
      position:fixed; width:8px; height:8px;
      pointer-events:none; opacity:0.8;
      animation:fall 2.5s linear forwards;
    }
    @keyframes fall {
      0%   { transform:translateY(0) rotate(0deg); opacity:1; }
      100% { transform:translateY(100vh) rotate(720deg); opacity:0; }
    }

    /* Mobile */
    @media (max-width: 480px) {
      header h1 { font-size:1.4rem; }
      .tab-btn, .toggle-btn, button {
        font-size:.95rem; padding:10px; flex:1 1 100%;
      }
      table { min-width:auto; }
      th, td { padding:8px; font-size:.9rem; }
      td input { padding:10px; font-size:1.1rem; }
      tr { height:56px; }
      .remark { font-size:1rem; padding:10px; }
      .unique-message { font-size:.9rem; }
    }
  </style>
</head>
<body class="light-mode">

  <div class="container">
    <header>
      <h1><i class="fa-solid fa-calculator"></i> Grades Calculator</h1>
      <div class="toggles">
        <button id="btnSem1" class="tab-btn active">S1</button>
        <button id="btnSem2" class="tab-btn">S2</button>
        <button id="themeToggle" class="toggle-btn">
          <i class="fa-solid fa-moon"></i> Dark Mode
        </button>
      </div>
    </header>

    <!-- Sem 1 -->
    <div id="sem1">
      <div class="table-wrap">
        <table>
          <tr><th>Mod</th><th>Coef</th><th>TD</th><th>TP</th><th>EX</th><th>Avg</th></tr>
          <tr><td>RP</td><td>3</td><td><input class="tdRP1"></td><td><input class="tpRP1"></td><td><input class="examRP1"></td><td class="avgRP1"></td></tr>
          <tr><td>APG</td><td>3</td><td><input class="tdAPG1"></td><td><input class="tpAPG1"></td><td><input class="examAPG1"></td><td class="avgAPG1"></td></tr>
          <tr><td>TI</td><td>2</td><td><input class="tdTI1"></td><td>â€”</td><td><input class="examTI1"></td><td class="avgTI1"></td></tr>
          <tr><td>SR</td><td>2</td><td><input class="tdSR1"></td><td>â€”</td><td><input class="examSR1"></td><td class="avgSR1"></td></tr>
          <tr><td>FED</td><td>2</td><td><input class="tdFED1"></td><td>â€”</td><td><input class="examFED1"></td><td class="avgFED1"></td></tr>
          <tr><td>CRY</td><td>2</td><td><input class="tdCRYPTO1"></td><td>â€”</td><td><input class="examCRYPTO1"></td><td class="avgCRYPTO1"></td></tr>
          <tr><td>ASII</td><td>2</td><td>â€”</td><td><input class="tpASII1"></td><td><input class="examASII1"></td><td class="avgASII1"></td></tr>
          <tr><td>ANG</td><td>1</td><td>â€”</td><td>â€”</td><td><input class="examENG1"></td><td class="avgENG1"></td></tr>
          <tr><td><strong>Ov</strong></td><td colspan="5" class="overall1"></td></tr>
        </table>
      </div>
      <div class="btn-container">
        <div class="left">
          <input type="checkbox" id="adj1">
          <label for="adj1">Adjusted Weights</label>
          <span class="tooltip">ðŸ›ˆ
            <span class="tiptext">
              Switches from 0.33 TD / 0.67 EX to precise 0.3333 / 0.6777 weighting.
            </span>
          </span>
        </div>
        <div class="right">
          <button id="calc1"><i class="fa-solid fa-calculator"></i> Calc S1</button>
          <button id="reset1" class="reset"><i class="fa-solid fa-rotate-left"></i> Reset S1</button>
        </div>
      </div>
      <div id="remark1" class="remark"></div>
      <div id="msg1" class="unique-message"></div>
    </div>

    <!-- Sem 2 -->
    <div id="sem2" style="display:none">
      <div class="table-wrap">
        <table>
          <tr><th>Mod</th><th>Coef</th><th>TD</th><th>TP</th><th>EX</th><th>Avg</th></tr>
          <tr><td>ANG</td><td>1</td><td>â€”</td><td>â€”</td><td><input class="examAng2"></td><td class="avgAng2"></td></tr>
          <tr><td>PS</td><td>2</td><td><input class="tdPS2"></td><td>â€”</td><td><input class="examPS2"></td><td class="avgPS2"></td></tr>
          <tr><td>EV</td><td>3</td><td><input class="tdEV2"></td><td><input class="tpEV2"></td><td><input class="examEV2"></td><td class="avgEV2"></td></tr>
          <tr><td>RT</td><td>2</td><td>â€”</td><td><input class="tpRT2"></td><td><input class="examRT2"></td><td class="avgRT2"></td></tr>
          <tr><td>VULN</td><td>2</td><td>â€”</td><td><input class="tpVS2"></td><td><input class="examVS2"></td><td class="avgVS2"></td></tr>
          <tr><td>BDR</td><td>2</td><td><input class="tdBD2"></td><td>â€”</td><td><input class="examBD2"></td><td class="avgBD2"></td></tr>
          <tr><td>RFM</td><td>2</td><td>â€”</td><td><input class="tpRF2"></td><td><input class="examRF2"></td><td class="avgRF2"></td></tr>
          <tr><td>RAV</td><td>3</td><td><input class="tdRA2"></td><td><input class="tpRA2"></td><td><input class="examRA2"></td><td class="avgRA2"></td></tr>
          <tr><td><strong>Ov</strong></td><td colspan="5" class="overall2"></td></tr>
        </table>
      </div>
      <div class="btn-container">
        <div class="left">
          <input type="checkbox" id="adj2">
          <label for="adj2">Adjusted Weights</label>
          <span class="tooltip">ðŸ›ˆ
            <span class="tiptext">
              Switches from 0.33 TD / 0.67 EX to precise 0.3333 / 0.6777 weighting.
            </span>
          </span>
        </div>
        <div class="right">
          <button id="calc2"><i class="fa-solid fa-calculator"></i> Calc S2</button>
          <button id="reset2" class="reset"><i class="fa-solid fa-rotate-left"></i> Reset S2</button>
        </div>
      </div>
      <div id="remark2" class="remark"></div>
      <div id="msg2" class="unique-message"></div>
    </div>

    <!-- Reset All -->
    <button id="resetAll" class="reset" style="width:100%; margin-top:10px;">
      <i class="fa-solid fa-trash"></i> Reset All
    </button>
  </div>

  <div id="confettiContainer"></div>

  <script>
    // Helpers
    const safe = v=>{const n=parseFloat(v); return isNaN(n)?0:n;};
    const colorCell = (c,v)=>{ c.classList.remove('pass','fail'); c.classList.add(v>=10?'pass':'fail'); };

    // Tabs
    btnSem1.onclick=()=>{
      sem1.style.display='block'; sem2.style.display='none';
      btnSem1.classList.add('active'); btnSem2.classList.remove('active');
    };
    btnSem2.onclick=()=>{
      sem2.style.display='block'; sem1.style.display='none';
      btnSem2.classList.add('active'); btnSem1.classList.remove('active');
    };

    // Theme
    themeToggle.onclick=()=>{
      const isDark = document.body.classList.toggle('dark-mode');
      document.body.classList.toggle('light-mode');
      themeToggle.innerHTML = isDark
        ? '<i class="fa-solid fa-sun"></i> Light Mode'
        : '<i class="fa-solid fa-moon"></i> Dark Mode';
    };

    // Confetti
    function launchConfetti(){
      const C=document.getElementById('confettiContainer');
      for(let i=0;i<40;i++){
        const d=document.createElement('div');
        d.className='confetti-piece';
        d.style.background=`hsl(${Math.random()*360},80%,60%)`;
        d.style.left=`${Math.random()*100}vw`;
        C.appendChild(d);
        setTimeout(()=>d.remove(),2500);
      }
    }

    // Bind semester calculators
    function bindCalc(pref, mods, coefs){
      document.getElementById('calc'+pref).onclick=()=>{
        const useAdj=document.getElementById('adj'+pref).checked;
        const wTD=useAdj?0.3333:0.33, wEX=useAdj?0.6777:0.67;
        let tot=0,sum=0;
        mods.forEach((m,i)=>{
          const td=safe(document.querySelector('.td'+m+pref)?.value);
          const tp=safe(document.querySelector('.tp'+m+pref)?.value);
          const ex=safe(document.querySelector('.exam'+m+pref)?.value);
          const base=(td+tp)>0?(td+tp)/2:td+tp;
          const avg=base*wTD + ex*wEX;
          const cell=document.querySelector('.avg'+m+pref);
          cell.textContent=avg.toFixed(2);
          colorCell(cell,avg);
          tot+=avg*coefs[i]; sum+=coefs[i];
        });
        const overall=tot/sum;
        const ov=document.querySelector('.overall'+pref);
        ov.textContent=overall.toFixed(2);
        colorCell(ov,overall);

        const R=document.getElementById('remark'+pref),
              M=document.getElementById('msg'+pref);
        if(overall>=10){
          R.textContent=`Sem ${pref} Passed ðŸŽ‰`; R.style.background='rgba(100,255,100,0.3)';
          M.textContent='Great job! Keep it up.'; launchConfetti();
        } else {
          R.textContent=`Sem ${pref} Needs Work ðŸ˜…`; R.style.background='rgba(255,100,100,0.3)';
          M.textContent='';
        }
      };

      document.getElementById('reset'+pref).onclick=()=>{
        document.querySelectorAll(`#sem${pref} input`).forEach(i=>i.value='');
        document.querySelectorAll(`#sem${pref} .pass,#sem${pref} .fail`)
          .forEach(c=>c.classList.remove('pass','fail'));
        document.querySelector(`.overall${pref}`).textContent='';
        const R=document.getElementById('remark'+pref),
              M=document.getElementById('msg'+pref);
        R.textContent=''; R.style.background='none';
        M.textContent='';
        document.getElementById('adj'+pref).checked=false;
      };
    }

    bindCalc('1',['RP','APG','TI','SR','FED','CRYPTO','ASII','ENG'],[3,3,2,2,2,2,2,1]);
    bindCalc('2',['Ang','PS','EV','RT','VS','BD','RF','RA'],[1,2,3,2,2,2,2,3]);

    // Reset All
    resetAll.onclick=()=>{
      ['1','2'].forEach(pref=>{
        document.querySelectorAll(`#sem${pref} input`).forEach(i=>i.value='');
        document.querySelectorAll(`#sem${pref} .pass,#sem${pref} .fail`)
          .forEach(c=>c.classList.remove('pass','fail'));
        const ov=document.querySelector('.overall'+pref),
              R=document.getElementById('remark'+pref),
              M=document.getElementById('msg'+pref);
        ov.textContent=''; R.textContent=''; R.style.background='none'; M.textContent='';
        document.getElementById('adj'+pref).checked=false;
      });
    };
  </script>
</body>
</html>
